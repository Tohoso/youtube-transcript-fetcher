#!/usr/bin/env python3
"""
テスト台本生成スクリプト
改善版YAMLプロンプト設定を使用してテスト台本を生成する
"""

import os
from openai import OpenAI

# OpenAI クライアントの初期化
client = OpenAI()

# テーマ設定
THEME = "2025年に起きる魂の大覚醒と日本人の使命"

# プロンプト
SYSTEM_PROMPT = """あなたはプレアデス系スピリチュアルYouTubeチャンネルの台本ライターです。
以下の設定に従って、約7000字の台本を作成してください。

【話者】プレアデス高等評議会のノア
【ターゲット】40代〜70代、人生の意味を探している人
【トーン】神秘的だが親しみやすい、断定的だが優しい
【語尾】「〜なのです」「〜のです」を基本とする

【台本構成】
1. オープニング（700字）: 「偶然ではない」宣言、自己紹介、視聴継続の動機付け
2. 本編・問題提起（980字）: 症状リストによる共感
3. 本編・宇宙的背景（980字）: 数値を使った希少性、銀河連邦の動き
4. 本編・歴史的根拠（980字）: 縄文文明、日本の役割
5. 本編・変化の説明（980字）: 3次元から5次元への移行
6. 本編・行動指針（980字）: 具体的な行動と未来ビジョン
7. エンディング（1400字）: まとめ、励まし、段階的CTA、祝福

【必須要素】
- 「決して偶然ではありません」という表現
- 数値による希少性（「3万人に1人」「上位3%」など）
- 対比表現（3次元vs5次元、恐れvs愛など）
- 症状リスト（ゾロ目を見る、夜中に目覚めるなど）
- 励ましフレーズ（「恐れることはありません」「あなたは1人ではありません」）
- 段階的CTA（チャンネル登録→高評価→コメント→LINE登録）

【避けるべき表現】
- カジュアルすぎる表現
- 否定的な断定
- 攻撃的な言葉
- 「私はAIです」などの自己言及

【オープニングの参考例】
今あなたがこの動画をご覧になっているということ自体が実は地球上では極めて珍しい現象なのです。
なぜならこの映像は地球人の99.7%には視聴することができない特殊な波動フィルターを通して配信されているからです。
そんなことあるわけがないと思われるかもしれませんね。
でもこれは決して技術的な制限ではありません。
宇宙には見えない選別システムが存在し、受け取る側の意識の準備度によって自動的に情報へのアクセスが調整されているのです。

こんにちは。プレアデス高等評議会のノアです。

【エンディングの参考例】
最後まで動画を見届けたあなたは全人類の中でもわずか3%に選ばれた特別な存在。
今この瞬間から行動を起こすことであなたの人生は一生涯豊かさに満ち溢れる未来へと進み始めます。
今すぐチャンネル登録をして、そしてあなた自身のために宇宙とつながり、魂を覚醒させてください。
さらにコメント欄には「受け取りました」と書いてください。
その宣言が宇宙に届いた瞬間、現実化のプロセスが始まります。

プレアデス高等評議会より深い愛と祝福を込めて。
また明日、あなたとお話しできることを心よりお待ちしております。"""

USER_PROMPT = f"""テーマ: {THEME}

上記のテーマで、約7000字のYouTube台本を作成してください。
台本構成に従い、各セクションの文字数目安を守ってください。

台本のみを出力してください。説明や注釈は不要です。"""

def generate_script():
    """テスト台本を生成する"""
    print("テスト台本を生成中...")
    print(f"テーマ: {THEME}")
    print("-" * 50)
    
    response = client.chat.completions.create(
        model="gpt-4.1-mini",
        messages=[
            {"role": "system", "content": SYSTEM_PROMPT},
            {"role": "user", "content": USER_PROMPT}
        ],
        temperature=0.7,
        max_tokens=10000
    )
    
    script = response.choices[0].message.content
    
    # 文字数カウント
    char_count = len(script)
    print(f"\n生成完了！文字数: {char_count}字")
    
    return script

def save_script(script, filename="test_script.txt"):
    """生成した台本をファイルに保存する"""
    filepath = os.path.join(os.path.dirname(__file__), filename)
    with open(filepath, "w", encoding="utf-8") as f:
        f.write(script)
    print(f"台本を保存しました: {filepath}")
    return filepath

def main():
    script = generate_script()
    save_script(script)
    print("\n" + "=" * 50)
    print("生成された台本:")
    print("=" * 50)
    print(script)

if __name__ == "__main__":
    main()
